#!/usr/bin/env python3
import sys

CVEs = {
    "CONFIG_MEMORY_FAILURE" : ["CVE-2019-10124"],
    "CONFIG_IPMI_HANDLER" : ["CVE-2019-9003"],
    "CONFIG_IP_SCTP" : ["CVE-2019-8956"],
    "CONFIG_BPF_SYSCALL" : ["CVE-2019-3887"],
    "CONFIG_HID" : ["CVE-2019-3819"],
    "CONFIG_DEBUG_FS" : ["CVE-2019-3819"],
    "CONFIG_GNX2X" : ["CVE-2018-1000026"],
    "CONFIG_IPDDP" : ["CVE-2018-20511"],
    "CONFIG_USB" : ["CVE-2018-20169"],
    "CONFIG_USER_NS" : ["CVE-2018-18955"],
    "CONFIG_BPF_SYSCALL" : ["CVE-2018-18445"],
    "CONFIG_MMU": ["CVE-2018-18281"],
    "CONFIG_KVM_ARM_HOST": ["CVE-2018-18021"],
    "CONFIG_CDROM" : ["CVE-2018-16658"],
    "CONFIG_PARAVIRT" : ["CVE-2018-15594"],
    "CONFIG_" : ["CVE-2018-15572"], # means it's in kernel for sure.
    "CONFIG_ISCSI_TARGET" : ["CVE-2018-14633"],
    "CONFIG_INET" : ["CVE-2018-5391", "CVE-2018-5390"],
    "CONFIG_VHOST" : ["CVE-2018-1118"],
}

if __name__ == '__main__':
    for cve in CVEs['CONFIG_']:
        print("CONFIG_", cve)
    for line in open(sys.argv[1]):
        line = line.strip()
        cols = line.split('=')
        config = cols[0]
        if config in CVEs:
            for cve in CVEs[config]:
                print(config, cve)
