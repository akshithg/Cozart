#!/usr/bin/env python3
import sys

CVEs = {
    "CONFIG_BINFMT_ELF": ["CVE-2019-11190"],
    "CONFIG_MEMORY_FAILURE": ["CVE-2019-10124"],
    "CONFIG_IPMI_HANDLER": ["CVE-2019-9003"],
    "CONFIG_IP_SCTP": ["CVE-2019-8956"],
    "CONFIG_BPF_SYSCALL": ["CVE-2019-7308"],
    "CONFIG_CHR_DEV_SG": ["CVE-2018-1000204"],
    "CONFIG_IPDDP": ["CVE-2018-20511"],
    "CONFIG_USB": ["CVE-2018-20169"],
    "CONFIG_XFS_FS": ["CVE-2018-18690", "CVE-2016-10741"],
    "CONFIG_TTY": ["CVE-2018-18386"],
    "CONFIG_":
    ["CVE-2018-10124", "CVE-2018-10087", "CVE-2017-18344", "CVE-2017-18202"],
    "CONFIG_PROC_FS": ["CVE-2018-1120"],
    "CONFIG_KVM_ARM_HOST": ["CVE-2018-18021"],
    "CONFIG_BLK_DEV_IDECD": ["CVE-2018-16658", "CVE-2018-10940"],
    "CONFIG_BLK_DEV_SR": ["CVE-2018-16658", "CVE-2018-10940"],
    "CONFIG_PARIDE_PCD": ["CVE-2018-16658", "CVE-2018-10940"],
    "CONFIG_CDROM_PKTCDVD": ["CVE-2018-16658", "CVE-2018-10940"],
    "CONFIG_GDROM": ["CVE-2018-16658", "CVE-2018-10940"],
    "CONFIG_USB_YUREX": ["CVE-2018-16276"],
    "CONFIG_PARAVIRT": ["CVE-2018-15594"],
    "CONFIG_CRYPTO_USER_API_AEAD": ["CVE-2018-14619"],
    "CONFIG_FB_UVESA": ["CVE-2018-13406"],
    "CONFIG_KVM_INTEL": ["CVE-2018-12904", "CVE-2017-1000407"],
    "CONFIG_COMPAT": ["CVE-2018-11508"],
    #  "CONFIG_" : ["CVE-2018-11232"],
    "CONFIG_NETLABEL": ["CVE-2018-10938"],
    "CONFIG_EXT4_FS": [
        "CVE-2018-10883", "CVE-2018-10881", "CVE-2018-10880", "CVE-2018-10879",
        "CVE-2018-10878"
    ],
    "CONFIG_NUMA": ["CVE-2018-10675"],
    #  "CONFIG_" : ["CVE-2018-10074"],
    "CONFIG_SCSI_SAS_LIBSAS": ["CVE-2018-10021"],
    "CONFIG_DRM_UDL": ["CVE-2018-8781"],
    "CONFIG_BLK_CGROUP": ["CVE-2018-7480"],
    "CONFIG_FUTEX": ["CVE-2018-6927"],
    "CONFIG_IRDA": ["CVE-2018-6555", "CVE-2018-6554"],
    "CONFIG_IP_DCCP": ["CVE-2018-1130"],
    "CONFIG_BRIDGE_NF_EBTABLES": ["CVE-2018-1068"],
    "CONFIG_PRINTER": ["CVE-2017-1000363"],
    "CONFIG_USB_SERIAL_EDGEPORT_TI": ["CVE-2017-18360"],
    "CONFIG_KEYS": ["CVE-2017-18270"],
    "CONFIG_ARM64": ["CVE-2017-18261"],
    "CONFIG_F2FS_FS":
    ["CVE-2017-18257", "CVE-2017-18249", "CVE-2017-18241", "CVE-2017-18193"],
    "CONFIG_PERF_EVENTS": ["CVE-2017-18255"],
    "CONFIG_OCFS2_FS": ["CVE-2017-18224"],
    "CONFIG_HNS_DSAF": ["CVE-2017-18222"],
    "CONFIG_MMU": ["CVE-2018-18281", "CVE-2017-18221"],
    "CONFIG_HNS_NET": ["CVE-2017-18218"],
    "CONFIG_OCFS2_FS": ["CVE-2017-18216", "CVE-2017-18204"],
    "CONFIG_ADVISE_SYSCALLS": ["CVE-2017-18208"],
    "CONFIG_MD": ["CVE-2017-18203"],
    "CONFIG_PINCTRL_AMD": ["CVE-2017-18174"],
    "CONFIG_SERIO_I8042": ["CVE-2017-18079"],
    "CONFIG_CRYPTO_PCRYPT": ["CVE-2017-18075"],
    "CONFIG_KEYS": ["CVE-2017-17807", "CVE-2016-0728"],
    "CONFIG_CRYPTO_HMAC": ["CVE-2017-17806"],
    "CONFIG_CRYPTO_SALSA20": ["CVE-2017-17805"],
    "CONFIG_CRYPTO_SALSA20_X86_64": ["CVE-2017-17805"],
    "CONFIG_MODIFY_LDT_SYSCALL": ["CVE-2017-17053"],
    "CONFIG_MMU": ["CVE-2017-16994"],
    "CONFIG_XFRM_USER": ["CVE-2017-16939"],
    "CONFIG_NET": ["CVE-2017-15129"],
    "CONFIG_HUGETLBFS": ["CVE-2017-15127"],
    "CONFIG_ASSOCIATIVE_ARRAY": ["CVE-2017-12193"],
    "CONFIG_KVM": ["CVE-2017-7518"],
    "CONFIG_AF_RXRPC": ["CVE-2017-7482"],
    "CONFIG_SECURITY_SELINUX": ["CVE-2017-2618"],
    "CONFIG_SND_HRTIMER": ["CVE-2016-2549"],
    "CONFIG_SND_TIMER": [
        "CVE-2016-2549", "CVE-2016-2548", "CVE-2016-2547", "CVE-2016-2546",
        "CVE-2016-2545"
    ],
    "CONFIG_SND_SEQUENCER": ["CVE-2016-2544", "CVE-2016-2543"],
    "CONFIG_X86": ["CVE-2018-15572", "CVE-2016-2069"],
    "CONFIG_POWERPC": ["CVE-2015-8845"],
    "CONFIG_X509_CERTIFICATE_PARSER": ["CVE-2015-5327"],
    "CONFIG_UNIX": ["CVE-2013-4312"],
}

if __name__ == '__main__':
    for cve in CVEs['CONFIG_']:
        print("CONFIG_", cve)
    for line in open(sys.argv[1]):
        line = line.strip()
        cols = line.split('=')
        config = cols[0]
        if len(cols) < 2:
            continue
        if cols[1] not in "my":
            continue
        if config in CVEs:
            for cve in CVEs[config]:
                print(config, cve)
